---
description: finance í”„ë¡œì íŠ¸ì— ìƒˆ ìƒê´€ê´€ê³„ ì°¨íŠ¸ë¥¼ ì¶”ê°€í•˜ëŠ” ì „ì²´ ì›Œí¬í”Œë¡œìš° (Python ìŠ¤í¬ë¦½íŠ¸ ìƒì„±, index.html íŒ¨ì¹˜, GitHub Actions ì—…ë°ì´íŠ¸)
globs: functions/*.py, docs/index.html, .github/workflows/*.yml, scripts/add_chart.py
alwaysApply: false
---

# finance ì°¨íŠ¸ ì¶”ê°€ ì›Œí¬í”Œë¡œìš°

ìƒˆ ì§€í‘œ ì°¨íŠ¸ë¥¼ ì¶”ê°€í•  ë•ŒëŠ” **`scripts/add_chart.py`ë¥¼ ë¨¼ì € ì‹¤í–‰**í•´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ë¥¼ ìë™ ìƒì„±í•œë‹¤.

## CLI ì‹¤í–‰ (ë¹ ë¥¸ ì‹œì‘)

```bash
# yfinance ê¸°ë°˜ (ì˜ˆ: VIX)
python scripts/add_chart.py vix \
    --emoji ğŸ˜¨ --color "#E91E63" --invert \
    --suffix "%" --format ".2f" \
    --label-ko "VIX ê³µí¬ì§€ìˆ˜" --label-en "VIX Fear Index" \
    --label-zh "VIXææ…ŒæŒ‡æ•°" --label-ja "VIXææ€–æŒ‡æ•°" \
    --source yfinance --ticker "^VIX"

# FRED ê¸°ë°˜ (ì˜ˆ: CPI)
python scripts/add_chart.py cpi \
    --emoji ğŸ”¥ --color "#FF5722" --invert \
    --suffix "%" --label-ko "CPI ì¸í”Œë ˆì´ì…˜" --label-en "CPI Inflation" \
    --label-zh "CPIé€šè´§è†¨èƒ€" --label-ja "CPIã‚¤ãƒ³ãƒ•ãƒ¬" \
    --source fred --fred-series CPIAUCSL

# ê²€ì¦
python scripts/add_chart.py <key> --validate
```

## CLIê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒ

| í•­ëª© | íŒŒì¼ |
|------|------|
| Python ì°¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸ í…œí”Œë¦¿ | `functions/{key}_sp500_chart.py` |
| ì‚¬ì´ë“œë°” nav í•­ëª© | `docs/index.html` |
| VIEWS ê°ì²´ í•­ëª© | `docs/index.html` |
| 4ê°œ ì–¸ì–´ ë²ˆì—­ í‚¤ | `docs/index.html` |
| GitHub Actions step | `.github/workflows/update_chart.yml` |

## CLI ì‹¤í–‰ í›„ ìˆ˜ë™ ì™„ë£Œ í•­ëª©

1. `functions/{key}_sp500_chart.py` â€” `fetch_{key}()` í•¨ìˆ˜ ë¡œì§ í™•ì¸/ìˆ˜ì •
2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰: `MPLBACKEND=Agg python3 functions/{key}_sp500_chart.py`
3. JSON ìƒì„± í™•ì¸: `ls docs/{key}_data.json`
4. ë¸Œë¼ìš°ì € í™•ì¸: `cd docs && python3 -m http.server 8000`

## ì£¼ìš” ê·œì¹™

### `yScale` â€” yì¶• ë°˜ì „ ë°©ì‹
Plotlyì˜ `autorange:'reversed'` + `overlaying:'y'` ì¡°í•©ì€ ì‹ ë¢°ë„ê°€ ë‚®ë‹¤.
ë°˜ì „ì´ í•„ìš”í•œ ì§€í‘œ(`--invert`)ëŠ” **ë°ì´í„°ë¥¼ ìŒìˆ˜ ë³€í™˜** (`yScale: -1`) + **ì»¤ìŠ¤í…€ í‹±**ì„ ì‚¬ìš©í•œë‹¤.

```javascript
// âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (ê¸°ì¤€ê¸ˆë¦¬, VIX ë“±)
yScale: -1,
fill: 'none',   // tozeroyê°€ ì „ ì˜ì—­ì„ ì±„ì›Œë²„ë¦¬ë¯€ë¡œ ì œê±°
hoverTmpl: '%{customdata:.2f}%',  // customdataì— ì›ë³¸ ì–‘ìˆ˜ê°’

// âŒ ì‚¬ìš© ê¸ˆì§€
autorange: 'reversed'  // overlaying:'y'ì—ì„œ ë¬´ì‹œë¨
```

### `hoverTmpl`
- ë°˜ì „ ì—†ëŠ” ì§€í‘œ: `'%{y:,.1f}B'` ë˜ëŠ” `'%{y:.2f}%'`
- ë°˜ì „ ì§€í‘œ (`yScale: -1`): `'%{customdata:.2f}%'` (yê°€ ìŒìˆ˜ì´ë¯€ë¡œ customdata ì‚¬ìš©)

### ì°¨íŠ¸ ì•„ì´ë””ì–´ (ì¶”ì²œ KEY ëª©ë¡)

| KEY | ì§€í‘œ | ì†ŒìŠ¤ | `--invert` |
|-----|------|------|-----------|
| `vix` | VIX ê³µí¬ì§€ìˆ˜ | yfinance `^VIX` | âœ… |
| `dxy` | ë‹¬ëŸ¬ì¸ë±ìŠ¤ | yfinance `DX-Y.NYB` | âœ… |
| `yield10` | 10ë…„ë¬¼ êµ­ì±„ê¸ˆë¦¬ | FRED `GS10` | âœ… |
| `m2` | M2 í†µí™”ëŸ‰ | FRED `M2SL` | âŒ |
| `cpi` | CPI | FRED `CPIAUCSL` | âœ… |
| `unemployment` | ì‹¤ì—…ë¥  | FRED `UNRATE` | âœ… |
| `oil` | WTI ì›ìœ  | yfinance `CL=F` | âŒ |
| `gold` | ê¸ˆ ê°€ê²© | yfinance `GC=F` | âŒ |
| `btc` | ë¹„íŠ¸ì½”ì¸ | yfinance `BTC-USD` | âŒ |
